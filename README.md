# Личный кабинет партнеров "Астрон"

Основная ссылка - https://astron-lk-murex.vercel.app/

## Данные для авторизации

Партнер:
логин - partner@partner.ru, пароль - partner

Манагер:
логин - manager@manager.ru, пароль - manager

Сотрудник:
логин - employee@employee.ru, пароль - employee

## Примечания к серверу

Серверная часть без базы данных, просто моковые данные. Основной бэк на битриксе.

https://astron-lk-server.vercel.app/api/docs - ссылка на OpenAPI

## Основные моменты по проекту

На проекте развернут pnpm монорепозиторий с помощью turborepo

packages не удается импортировать в server (причину выяснить не удалось)

На клиенте `Vite` с `React`

Вся архитектура клиента выстроена по методологии FSD

На сервере размещена OpenAPI документация `public/schema.yaml`

На основе OpenAPI документации генерируется api клиент, через который проходят все запросы на сайте

API клиент типизируется и валидируется с помощью `zod` и `typescript` (запросы могут выполянться, но до клиента не дойдут, если не пройдут валидацию zod схемы, которая описывается и генерируется через OpenAPI схему)

Для генерации нового апи клиента нужно запустить команду с запушенным сервером `pnpm api:generate`

Все запросы отправляются через `@tanstack/react-query`

UI Компоненты проекта базируются на `shadcn`

Для готового билда сборку нужно собирать с изменением базовой директории на `/cabinet` как для `vite`, так и для `react-router-dom`

Команды для сборки:

- `pnpm build` - базовая сборка
- `pnpm build:prod` - билд для боевого сайта, там указывается url для api запросов, если он поменяется, то в package.json клиента нужно внести изменения
- `pnpm build:test` - билд для тестового сайта, там указывается url для api запросов, если он поменятеся, то в package.json клиента нужно внести изменения

Деплой выполняется вручную:

- Нужно по sftp скачать папку `cabinet/assets` с хоста, в нее закинуть новые скрипты из `apps/client/dist/assets`.
- Удалить папку из хоста `cabinet/assets`.
- Загрузки на хост локалькую папку `cabinet/assets` с новыми скриптами и стилями (правая кнопка мыши по папке cabinet в vscode, `sync local -> remote`).
- Обновить подключения скриптов и стилей в `cabinet/index.php` из `apps/client/dist/index.html`.
